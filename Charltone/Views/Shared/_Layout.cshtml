<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>@ViewBag.Title</title>
        <link href="@Url.Content("~/Content/Site.css")" rel="stylesheet" type="text/css" />
	    <link href="@Url.Content("~/Content/favicon.png")" rel="icon" type="image/png"  />
        <!--[if IE]>
	    <link href="@Url.Content("~/Content/favicon.ico")" rel="shortcut icon" type="image/vnd.microsoft.icon" />
	    <![endif]-->
	
        <script src="~/Scripts/jquery-2.1.3.min.js"></script>
        <script src="~/Scripts/jquery-ui-1.11.4.min.js"></script>
        <script src="~/Scripts/jquery.blockUI.js" type="text/javascript"></script>
        <script src="~/Scripts/jquery.loupe.js" type="text/javascript"></script>
        <script src="~/Scripts/jquery.loupe.min.js" type="text/javascript"></script>
        
        <script type="text/javascript">
            function showPic(id) 
            {
                document.images['mainphoto'].src = "/Instrument/GetPhoto/" + id;
            }
        </script>

    </head>

    <body>
        <script type="text/javascript">
            $(document).ready(function () {
                var htmlAdminLogin;

                createAdminLogInForm();
                $("#admin-login-form").hide();

                function displayAdminLoginDialog() {
                    $.blockUI({
                        message: $("#admin-login-form"),
                        width: '300px'
                    });

                    $("button").button();
                    $("#validation-container-admin-login").hide();
                }

                function createAdminLogInForm() {
                    var wrapper = $("#dialog-wrapper");
                    var html = "<div id='admin-login-form'><div id='admin-login'></div>";
                    html = html + "<div class='dialog-header'><h2>Admin Log In</h2></div><div id='admin-login-credentials'>";
                    html = html + "<div class='password'><div class='login-label'>Password</div>";
                    html = html + "<div class='login-input'><input type='password' id='txtPassword' class='textbox-password' maxlength=20/></div></div></div>";
                    html = html + "<div id='admin-login-cancel-button-container'><span id='login-button'><button id='btnLogInAdmin' type='button'>Log In</button></span> <span id='cancel-button'><button id='btnCancelAdminLogin' type='button'>Cancel</button></span></div>";
                    html = html + "<div id='validation-container-admin-login' class='validation-container'></div></div>";

                    htmlAdminLogin = html;

                    wrapper.append(html);

                    $("#btnCancelAdminLogin").click(function () {
                        $("#validation-container-admin-login").html("");
                        $.unblockUI();
                    });

                    $("#btnLogInAdmin").click(function () {
                        logInAdmin();
                    });

                    $('#admin-login-form').keyup(function (e) {
                        if (e.keyCode == 13) {
                            logInAdmin();
                        }
                    });

                    $("#lnk-admin-login").click(function () {
                        displayAdminLoginDialog();
                    });

                    $("#lnk-admin-logoff").click(function () {

                        var url = '@Url.Action("LogOff", "Admin")';
                        $.getJSON(url, null, function (data) {
                            if (data.success) {
                                window.location.reload(true);
                            }
                        });
                    });
                }

                function logInAdmin() {
                    var pword = $("#txtPassword").val();
                    var model = { password: pword };

                    $("#validation-container-admin-login").html("");

                    var url = '@Url.Action("LogIn", "Admin")';
                    $.getJSON(url, model,
                        function (data) {
                            if (data.success) {
                                $.unblockUI();
                                window.location.reload(true);
                            } else {
                                if (data.messages.length > 0) {
                                    $("#validation-container-admin-login").show();
                                    $("#validation-container-admin-login").html("");
                                    var html = "<ul>";
                                    for (var i = 0; i < data.messages.length; i++) {
                                        html = html + "<li>" + data.messages[i] + "</li>";
                                    }
                                    html = html + "</ul>";
                                    $("#validation-container-admin-login").append(html);
                                }
                            }
                        });
                }
            });
        </script>

        <div class="page">
            <div id="menubackground">
                <div id="logo">
                    <a id="lnk-admin-login" href="javascript:;">.</a>
                </div> 
                
                  <div id="menucontainer"> 
                    <ul id="menu">
                        <li>@Html.ActionLink("Home", "Index", "Home")</li>
                        <li>@Html.ActionLink("About Us", "About", "Home")</li>
                        <li>@Html.ActionLink("Instruments", "Index", "Instrument")</li>
                        <li>@Html.ActionLink("Ordering", "Index", "Ordering")</li>
                        <!--<li>@Html.ActionLink("Other Products", "Index", "Product")</li>-->
                        @if (Request.IsAuthenticated)
                        {
                            <li><a id="lnk-admin-logoff" href="javascript:;">Log Off</a></li>
                        }
                        else
                        {
                            <li>@Html.ActionLink("Contact", "Contact", "Home")</li>
                        }
                    </ul>
                </div>
            </div>

            <div id="main">
                <div id="dialog-wrapper"></div>
                @RenderBody()
            </div>
        </div>
    </body>
</html>
